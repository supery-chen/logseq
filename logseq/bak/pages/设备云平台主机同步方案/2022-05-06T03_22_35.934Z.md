public:: false

- #工作 #控客 #私有
- > 根据主机表现,实时更新画像
  根据主机画像,对主机进行打分
  根据主机打分,按优先级同步主机
	-
- ## 数据源
- > 数据主要来自kafka,处理后转换为打分平台对应事件,具体信息如下表
- |topic|来源|事件|
  |--|--|--|
  |inner-ccuRelation|iot-mqtt-auth|CCU_RELATION_CHANGED|
  |cloudReqRespInfo|API、SVC|CCU_OPT_EXECUTE[:br]CCU_OPT_RESP[:br]CCU_OPT_SUCCESS[:br]CCU_OPT_FAILED[:br]CCU_OPT_TIMEOUT|
  |inner-ccuOnline|SVC|CCU_ONLINE|
  |inner-ccuOffline|SVC|CCU_OFFLINE|
  |iot-ccuActive_NoWorkingOnline|SVC|CCU_ACTIVE_NOT_WORKING|
  |iot-ccuLinkHealthCheck_Success|SVC|CCU_HEALTH_CHECK_SUCCESS|
  |iot-ccuLinkHealthCheck_Failed|SVC|CCU_HEALTH_CHECK_FAILED|
  |iot-ccuWorkingOnline|SVC|CCU_SYNC_SUCCESS|
  |iot-ccuSync_SYNC_INFO_ERROR|SVC|CCU_SYNC_FAILED|
  -
- ## 画像
- > 根据事件更新画像信息,事件对应画像信息如下表
- |事件|画像key|
  |----|----|
  |CCU_RELATION_CHANGED||
  |CCU_OPT_EXECUTE||
  |CCU_OPT_RESP||
  |CCU_OPT_SUCCESS||
  |CCU_OPT_FAILED||
  |CCU_OPT_TIMEOUT||
  |CCU_ONLINE|basic.link=1<br />basic.link_type<br />stable.online_frequency+1<br />stable.last_online_time=eventTime<br />stable.last_10_onoff_records.push()|
  |CCU_OFFLINE|basic.link=0<br />stable.offline_frequency+1<br />stable.last_offline_time<br />stable.last_10_onoff_records|
  |CCU_ACTIVE_NOT_WORKING||
  |CCU_HEALTH_CHECK_SUCCESS||
  |CCU_HEALTH_CHECK_FAILED||
  |CCU_SYNC_SUCCESS|basic.link=1<br />stable.sync_frequency+1<br />stable.sync_success_frequency+1<br />stable.last_sync_complete_time<br />stable.last_sync_complete_result<br />stable.last_20_sync_result_records<br /><br />stable.active_no_working_online=0<br />stable.last_active_no_working_online_time=null<br />stable.health_check_success_frequency=null<br />stable.health_check_failed_frequency=null<br />stable.last_health_check_success_time=null<br />stable.last_health_check_failed_time=null<br />stable.no_link_frequency=0<br />stable.last_100_no_link_times=[]|
  |CCU_SYNC_FAILED||
- ## 打分
-
-
- ## 同步
-
-